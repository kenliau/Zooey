<!-- header and nav -->

<div class="row">
  <div class="seven columns">
    <h1>Job Description</h1>
  </div>
</div>

<!-- end header and nav -->


<div class="row">
  <noscript>
    <div class="alert-box">
      Please enable Javascript for this application to function properly.
    </div>
  </noscript>
</div>

<!-- Header and Nav -->

<div class="content">
  <div id="job-status">
    <% unless @job.finished_at %>
      <div class="row">
        <div class="twelve columns">
          <div class="progress-bars">
            <div class="row progress-bar pull-progress-bar">
              <div class="twelve columns">
                <h4>Pull Progress <small class="speed">Speed: 0mbps</small></h4>
                <div class="nice radius progress twelve">
                  <span style="width: 0;" class="meter"></span>
                </div>
              </div>
            </div>
            <div class="row progress-bar transcode-progress-bar">
              <div class="twelve columns">
                <h4>Transcode Progress <small class="speed">Speed: 0mbps</small></h4>
                <div class="nice radius success progress twelve">
                  <span style="width: 0;" class="meter"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% else %>
      <div class="row">
        <div class="twelve columns">
          <h3>Job Complete</h3>
          <div><a href="<%= @job.output_url %>">Link to transcoded video</a></div>
        </div>
      </div>
    <% end %>
  </div>

  <script id="finished-job-template" type="text/template">
      <div class="row">
        <div class="twelve columns">
          <h3>Job Complete</h3>
          <div><a href="{{= output_url }}">Link to transcoded video</a></div>
        </div>
      </div>
  </script>

  <div class ="row">
    <div class="twelve columns">
      <h4 class="subheader">Progress Milestones</h4>
      <table id="progression-table" class="twelve ">
        <thead>
          <tr>
            <th>Pull Start Time</th>
            <th>Pull Finish Time</th>
            <th>Chunk Start Time</th>
            <th>Chunk Finish Time</th>
            <th>Transcode Start Time</th>
            <th>Transcode Finish Time</th>
            <th>Merger Start Time</th>
            <th>Merger Finish Time</th>
          </tr>
         </thead>
        <tbody>
        <tr id="progress-row">
          <td><%= @job.progression.pull_start_time %></td>
          <td><%= @job.progression.pull_finish_time %></td>
          <td><%= @job.progression.chunker_start_time %></td>
          <td><%= @job.progression.chunker_finish_time %></td>
          <td><%= @job.progression.tcoder_start_time %></td>
          <td><%= @job.progression.tcoder_finish_time %></td>
          <td><%= @job.progression.merger_start_time %></td>
          <td><%= @job.progression.merger_finish_time %></td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script id="progression-template" type="text/template">
    <td>{{= progression.pull_start_time }}</td>
    <td>{{= progression.pull_finish_time }}</td>
    <td>{{= progression.chunker_start_time }}</td>
    <td>{{= progression.chunker_finish_time }}</td>
    <td>{{= progression.tcoder_start_time }}</td>
    <td>{{= progression.tcoder_finish_time }}</td>
    <td>{{= progression.merger_start_time }}</td>
    <td>{{= progression.merger_finish_time }}</td>
  </script>

  <% @video = Video.find(@job.video_id) %>
  <div class="row">
    <div class="twelve columns">
      <ul class="block-grid two-up mobile-one-up">
        <li>
          <div class="six columns">
            <h4 class="subheader">Video Specifications</h4>
          </div>

          <table id="video-table" class="twelve columns">
            <tbody>
            <tr>
              <td>Video Nickname :</td>
              <td><%= @video.video_name %></td>
            </tr>
            <tr>
              <td>Size :</td>
              <td><%= number_to_human_size(@video.size) %></td>
            </tr>
            <tr>
              <td>Duration :</td>
              <td><%= @video.duration %></td>
            </tr>
            <tr>
              <td>Location :</td>
              <td><%= @video.location %></td>
            </tr>
            <tr>
              <td>Frame Distance :</td>
              <td><%= @video.frame_distance %></td>
            </tr>
            <tr>
              <td>GOP Length :</td>
              <td><%= @video.gop_length %></td>
            </tr>
            <tr>
              <td>Created At :</td>
              <td><%= @video.created_at %></td>
            </tr>
            </tbody>
          </table>
        </li>

        <li>
          <div class="six columns">
            <h4 class="subheader">Job Specifications</h4>
          </div>
          <table id="job-table" class="twelve columns">
            <tbody id="job-table-body">
            <tr>
              <td>Width :</td>
              <td><%= @job.width %></td>
            </tr>
            <tr>
              <td>Height :</td>
              <td><%= @job.height %></td>
            </tr>
            <tr>
              <td>H264 Profile : </td>
              <td><%= @job.h264_profile  %></td>
            </tr>
            <tr>
              <td>H264 Quality : </td>
              <td><%= @job.h264_quality %></td>
            </tr>
            <tr>
              <td>Audio Codec :</td>
              <td><%= @job.audio_codec %></td>
            </tr>
            <tr>
              <td>Audio Bitrate :</td>
              <td><%= @job.audio_bitrate %></td>
            </tr>
            <tr>
              <td>Audio Volume :</td>
              <td><%= @job.audio_volume %></td>
            </tr>
            <tr>
              <td>Audio Mux Rate :</td>
              <td><%= @job.mux_rate %></td>
            </tr>
            <tr>
              <td>Output Size:</td>
              <td><%= @job.output_size || '-' %></td>
            </tr>
            <tr>
              <td>Created At :</td>
              <td><%= @job.created_at %></td>
            </tr>
            <tr>
              <td>Finished At :</td>
              <td><%= @job.finished_at || '-' %></td>
            </tr>
            </tbody>
          </table>
        </li>
      </ul>
    </div>
  </div>
</div>

<script id="job-template" type="text/template">
  <tr>
    <td>Width :</td>
    <td>{{= width }}</td>
  </tr>
  <tr>
    <td>Height :</td>
    <td>{{= height }}</td>
  </tr>
  <tr>
    <td>H264 Profile : </td>
    <td>{{= h264_profile }}</td>
  </tr>
  <tr>
    <td>H264 Quality : </td>
    <td>{{= h264_profile }}</td>
  </tr>
  <tr>
    <td>Audio Codec :</td>
    <td>{{= audio_codec }}</td>
  </tr>
  <tr>
    <td>Audio Bitrate :</td>
    <td>{{= audio_bitrate }}</td>
  </tr>
  <tr>
    <td>Audio Volume :</td>
    <td>{{= audio_volume }}</td>
  </tr>
  <tr>
    <td>Audio Mux Rate :</td>
    <td>{{= mux_rate }}</td>
  </tr>
  <tr>
    <td>Output Size:</td>
    <td>{{= output_size}}</td>
  </tr>
  <tr>
    <td>Created At :</td>
    <td>{{= created_at }}</td>
  </tr>
  <tr>
    <td>Finished At :</td>
    <td>{{= finished_at }}</td>
  </tr>
</script>
